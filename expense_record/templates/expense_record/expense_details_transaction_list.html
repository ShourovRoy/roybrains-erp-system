{% extends 'base.html' %} 

{% block content %}
<section class="py-5">
  <div class="container">
    <!-- Expense Book Header -->
    <div class="card bg-dark text-light border-secondary mb-4 shadow-sm">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-start">
          <div>
            <h3 class="fw-semibold mb-1">{{ expense_details.name }}</h3>
            <p class="text-secondary mb-2">
              {{ expense_details.description }}
            </p>
            <small class="text-muted">
              Created on {{ expense_details.created_at|date:"d M Y, h:i A" }}
            </small>
          </div>
        </div>
      </div>
    </div>

    <!-- Expense Summary -->
    <div class="row g-3 mb-4">
      <div class="col-md-4">
        <div class="card bg-dark border-secondary text-light h-100 shadow-sm">
          <div class="card-body">
            <small class="text-muted">Lifetime Expense</small>
            <h4 class="mt-1 text-danger fw-bold">
              ‚Çπ {{ life_time_expense|floatformat:2 }}
            </h4>
          </div>
        </div>
      </div>

      <div class="col-md-4">
        <div class="card bg-dark border-secondary text-light h-100 shadow-sm">
          <div class="card-body">
            <small class="text-muted">Today‚Äôs Expense</small>
            <h4 class="mt-1 text-warning fw-bold">
              ‚Çπ {{ today_expense|floatformat:2 }}
            </h4>
          </div>
        </div>
      </div>

      <div class="col-md-4">
        <div class="card bg-dark border-secondary text-light h-100 shadow-sm">
          <div class="card-body">
            <small class="text-muted">This Year</small>
            <h4 class="mt-1 text-info fw-bold">
              ‚Çπ {{ yearly_expense|floatformat:2 }}
            </h4>
          </div>
        </div>
      </div>
    </div>

    {% comment %} Date range filter {% endcomment %}
    <form method="get" class="card bg-dark border-secondary mb-4">
      <div class="card-body">
        <div class="row g-3 align-items-end">
          <!-- From Date -->
          <div class="col-md-4">
            <label for="start_date" class="form-label text-secondary">
              From Date
            </label>
            <input
              type="date"
              id="start_date"
              name="start_date"
              class="form-control"
              value="{{ request.GET.start_date }}"
            />
          </div>

          <!-- To Date -->
          <div class="col-md-4">
            <label for="end_date" class="form-label text-secondary">
              To Date
            </label>
            <input
              type="date"
              id="end_date"
              name="end_date"
              class="form-control"
              value="{{ request.GET.end_date }}"
            />
          </div>

          <!-- Buttons -->
          <div class="col-md-4 d-flex gap-2">
            <button type="submit" class="btn btn-primary w-100">
              üîç Filter
            </button>
            <a
              href="#"
              class="btn btn-secondary w-100"
            >
              ‚úñ Clear
            </a>
          </div>
        </div>
      </div>
    </form>

    <!-- Transactions Table -->
    <div class="card bg-dark text-light border-secondary shadow-sm">
      <div class="card-header border-secondary">
        <h5 class="mb-0 fw-semibold">Expense Transactions</h5>
      </div>

      <div class="card-body p-0">
        <div class="table-responsive">
          <table
            class="table table-dark table-striped table-hover align-middle mb-0"
          >
            <thead class="border-secondary">
              <tr>
                <th>Date</th>
                <th>Description</th>
                <th>Status</th>
                <th class="text-end">Debit</th>
                <th class="text-end">Credit</th>
              </tr>
            </thead>
            <tbody>
              {% for expense in expense_transactions %}
              <tr>
                <td class="text-nowrap">{{ expense.date|date:"d M Y" }}</td>
                <td>{{ expense.description }}</td>
                <td>
                  <span class="badge bg-secondary"> {{ expense.status }} </span>
                </td>
                <td class="text-end text-success fw-semibold">
                  {{ expense.debit|default:"0.00" }}
                </td>
                <td class="text-end text-danger fw-semibold">
                  {{ expense.credit|default:"0.00" }}
                </td>
              </tr>
              {% empty %}
              <tr>
                <td colspan="5" class="text-center text-muted py-4">
                  No expense transactions found
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock content %}
