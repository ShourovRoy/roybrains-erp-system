{% extends 'base.html' %}

{% block content %}
<section class="py-5 bg-dark text-light min-vh-100">
    <div class="container">
        
        <div class="d-flex justify-content-between align-items-center mb-4">
            <a href="javascript:history.back()" class="text-secondary text-decoration-none small">
                <i class="bi bi-arrow-left me-1"></i> Back to Bank Selection
            </a>
            <span class="x-small-label text-warning tracking-widest text-uppercase">Partial Payment Processing</span>
        </div>

        <div class="row g-3 mb-5">
            <div class="col-md-6">
                <div class="card bg-body-tertiary border-0 shadow-sm h-100 border-start border-warning border-4">
                    <div class="card-body p-3">
                        <label class="x-small-label text-secondary text-uppercase mb-2 d-block">Payee (Target Account)</label>
                        <h5 class="fw-bold text-white mb-1">{{ account.account_name }}</h5>
                        <div class="d-flex align-items-center gap-2">
                            <span class="text-warning fw-bold small">৳ {{ account.balance }}</span>
                            <span class="text-secondary opacity-50 small">| {{ account.address|truncatechars:30 }}</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card bg-body-tertiary border-0 shadow-sm h-100 border-start border-info border-4">
                    <div class="card-body p-3">
                        <label class="x-small-label text-secondary text-uppercase mb-2 d-block">Source Bank Account</label>
                        <h5 class="fw-bold text-white mb-1">{{ bank_details.account_name }}</h5>
                        <div class="d-flex align-items-center gap-2">
                            <span class="text-info fw-bold small">৳ {{ bank_details.balance }}</span>
                            <span class="text-secondary opacity-50 small">| {{ bank_details.branch }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="card bg-body-tertiary border-0 shadow-lg">
                    <div class="card-header bg-black bg-opacity-20 border-0 p-4 text-center">
                        <h4 class="fw-bold text-white mb-0">Record Outgoing Split</h4>
                        <p class="text-secondary small mb-0">Enter amounts to be deducted from Cash and Bank</p>
                    </div>

                    <div class="card-body p-4 p-md-5">
                        <form action="{% url 'financial-outflow-partial-action' account.pk bank_details.pk %}" method="post">
                            {% csrf_token %}
                            <input type="hidden" name="bank_id" value="{{bank_details.pk}}">
                            <input type="hidden" name="account_id" value="{{account.pk}}">

                            <div class="row g-4">
                                <div class="col-md-6">
                                    <label class="x-small-label text-secondary text-uppercase mb-2 d-block">Cash to Give</label>
                                    <div class="input-group">
                                        <span class="input-group-text bg-dark border-secondary border-opacity-25 text-warning">
                                            <i class="bi bi-cash-coin"></i>
                                        </span>
                                        <input 
                                            type="number" 
                                            name="cash_amount" 
                                            step="0.01" 
                                            class="form-control bg-dark text-white border-secondary border-opacity-25 py-3 fw-bold" 
                                            placeholder="0.00"
                                            autofocus
                                        >
                                    </div>
                                    <small class="text-warning opacity-75 x-small mt-2 d-block">Will be deducted from Cash In Hand.</small>
                                </div>

                                <div class="col-md-6">
                                    <label class="x-small-label text-secondary text-uppercase mb-2 d-block">Bank to Transfer</label>
                                    <div class="input-group">
                                        <span class="input-group-text bg-dark border-secondary border-opacity-25 text-info">
                                            <i class="bi bi-bank2"></i>
                                        </span>
                                        <input 
                                            type="number" 
                                            name="bank_amount" 
                                            step="0.01" 
                                            class="form-control bg-dark text-white border-secondary border-opacity-25 py-3 fw-bold" 
                                            placeholder="0.00"
                                        >
                                    </div>
                                    <small class="text-info opacity-75 x-small mt-2 d-block">Will be debited from {{ bank_details.account_name }}.</small>
                                </div>

                                <div class="col-12">
                                    <hr class="my-3 border-secondary border-opacity-10">
                                    <label class="x-small-label text-secondary text-uppercase mb-2 d-block">Transaction Schedule</label>
                                    <div class="input-group">
                                        <span class="input-group-text bg-dark border-secondary border-opacity-25 text-secondary px-3">
                                            <i class="bi bi-calendar-event"></i>
                                        </span>
                                        <input 
                                            class="form-control bg-dark text-white border-secondary border-opacity-25 py-3" 
                                            type="datetime-local" 
                                            name="datetime" 
                                            required
                                        >
                                    </div>
                                </div>

                                <div class="col-12 mt-4">
                                    <button class="btn btn-warning w-100 py-3 fw-bold text-dark shadow-sm" type="submit">
                                        <i class="bi bi-box-arrow-right me-2"></i> Confirm Split Payment
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<style>
    .bg-body-tertiary { background-color: #2b3035 !important; }
    .x-small-label { font-size: 0.65rem; font-weight: 800; letter-spacing: 1px; }
    .x-small { font-size: 0.75rem; }

    /* Standardized Dark Theme Inputs */
    .form-control { border-left: none !important; }
    .input-group-text {
        border-right: none !important;
        background-color: #1a1d20 !important;
    }
    .form-control:focus {
        background-color: #1a1d20 !important;
        border-color: #ffc107 !important;
        box-shadow: none;
        color: white;
    }

    input[type="datetime-local"]::-webkit-calendar-picker-indicator {
        filter: invert(1);
        opacity: 0.5;
    }

    .card { border-radius: 12px; }
    .border-start { border-left-width: 5px !important; }
    .btn-warning:hover { background-color: #e5ac00; transform: translateY(-1px); }
</style>
{% endblock content %}