{% extends 'internal_banking/internal_banking_base.html' %}

{% block internal_banking_content %}
<div class="container py-4 min-vh-100 bg-dark text-light">

    <div class="row justify-content-center mb-5">
        <div class="col-lg-9">
            <form action="{% url 'internal_banking_control_panel' %}" method="get">
                <div class="input-group shadow-sm border border-secondary border-opacity-25 rounded-3 overflow-hidden">
                    <span class="input-group-text bg-body-tertiary border-0 text-secondary px-3">
                        <i class="bi bi-search"></i>
                    </span>
                    <input type="search" 
                           name="search_bank" 
                           class="form-control bg-body-tertiary text-white border-0 py-3" 
                           placeholder="Search bank name or branch..."
                           value="{{ request.GET.search_bank|default:'' }}">
                    <button class="btn btn-primary px-4 fw-bold" type="submit">
                        Search Bank
                    </button>
                </div>
            </form>
        </div>
    </div>

    {% if banks %}
        <div class="row g-4">
            {% for bank in banks %}
                <div class="col-md-6 col-xl-4">
                    <div class="card bg-body-tertiary border-0 shadow-sm h-100 bank-result-card overflow-hidden">
                        <div class="d-flex h-100">
                            <div class="bg-primary opacity-50" style="width: 5px;"></div>
                            
                            <div class="card-body p-4">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <div class="icon-circle-sm bg-dark bg-opacity-25 text-primary">
                                        <i class="bi bi-bank"></i>
                                    </div>
                                    {% if bank.status == 'Active' %}
                                        <span class="pill-tag pill-success">Active</span>
                                    {% else %}
                                        <span class="pill-tag pill-warning">{{ bank.status }}</span>
                                    {% endif %}
                                </div>

                                <div class="mb-4">
                                    <h5 class="fw-bold text-white mb-1">{{ bank.account_name }}</h5>
                                    <p class="text-secondary x-small mb-0">
                                        <i class="bi bi-geo-alt me-1"></i> {{ bank.branch }}
                                    </p>
                                </div>

                                <div class="p-3 bg-dark bg-opacity-25 rounded-3 border border-secondary border-opacity-10 mb-4">
                                    <label class="x-small-label text-secondary text-uppercase d-block mb-1">Balance</label>
                                    <h4 class="fw-bold text-info mb-0">à§³ {{ bank.balance }}</h4>
                                </div>

                                <div class="d-flex gap-2">
                                    <a href="{% url 'internal_banking_withdraw' bank.pk %}" 
                                       class="btn btn-outline-danger btn-sm w-100 py-2 fw-bold">
                                        Withdraw
                                    </a>
                                    <a href="{% url 'internal_banking_deposite' bank.pk %}" 
                                       class="btn btn-outline-info btn-sm w-100 py-2 fw-bold">
                                        Deposit
                                    </a>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="text-center py-5 bg-body-tertiary rounded-3 shadow-sm border border-secondary border-opacity-10">
            <h5 class="text-secondary fw-light">No records found matching your search.</h5>
        </div>
    {% endif %}

</div>

<style>
    /* CONSISTENT COLORS */
    .bg-body-tertiary { background-color: #2b3035 !important; }
    .x-small-label { font-size: 0.65rem; font-weight: 800; letter-spacing: 1px; }
    .x-small { font-size: 0.75rem; }

    /* Pill Tags Styling */
    .pill-tag {
        padding: 3px 12px;
        border-radius: 50px;
        font-size: 0.65rem;
        font-weight: 800;
        text-transform: uppercase;
        border: 1px solid transparent;
    }
    .pill-success {
        background-color: rgba(40, 167, 69, 0.1);
        color: #28a745;
        border-color: rgba(40, 167, 69, 0.2);
    }
    .pill-warning {
        background-color: rgba(255, 193, 7, 0.1);
        color: #ffc107;
        border-color: rgba(255, 193, 7, 0.2);
    }

    /* Icon Styling */
    .icon-circle-sm {
        width: 35px;
        height: 35px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
    }

    /* Input Focus Sync */
    .form-control:focus {
        background-color: #2b3035 !important;
        box-shadow: none;
        color: white;
        border: none;
    }

    .bank-result-card {
        transition: transform 0.2s;
    }
    .bank-result-card:hover {
        transform: translateY(-4px);
        background-color: #32383e !important;
    }
</style>
{% endblock internal_banking_content %}