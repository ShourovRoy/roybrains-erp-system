{% extends 'base.html' %}

{% block style %}
<style>
  :root {
    --bg-canvas: #1a1d20;
    --bg-card: #2b3035;
    --accent: #0d6efd;
    --border: rgba(255, 255, 255, 0.1);
  }

  .x-small-label {
    font-size: 0.62rem;
    font-weight: 800;
    letter-spacing: 0.8px;
    color: #6c757d;
    text-transform: uppercase;
    margin-bottom: 2px;
  }

  .voucher-header {
    background-color: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 12px 12px 0 0;
    border-bottom: 2px solid var(--accent);
  }

  .table-container {
    background-color: var(--bg-card);
    border: 1px solid var(--border);
    border-top: none;
    border-radius: 0 0 12px 12px;
  }

  .ledger-table thead th {
    background-color: rgba(0, 0, 0, 0.2);
    color: #6c757d;
    font-size: 0.7rem;
    padding: 12px;
    border: none;
  }

  .ref-badge {
    font-size: 0.65rem;
    padding: 2px 6px;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid var(--border);
    border-radius: 4px;
    color: #adb5bd;
  }

  .amount-column {
    width: 120px;
    text-align: right;
  }

  .description-cell {
    max-width: 300px;
    white-space: normal;
  }
</style>
{% endblock style %}

{% block content %}
<section class="py-5 bg-dark text-light min-vh-100">
  <div class="container">
    
    <div class="voucher-header p-4 shadow-lg">
      <div class="row align-items-center">
        <div class="col-md-6">
          <div class="d-flex align-items-center mb-2">
            <div style="width: 4px; height: 24px; background-color: var(--accent); border-radius: 2px;" class="me-3"></div>
            <h3 class="fw-bold text-white m-0">Journal Voucher</h3>
          </div>
          <p class="text-secondary small mb-0 ms-4">
            {{ journal_details.business.business_name }} | {{ journal_details.business.business_address }}
          </p>
        </div>
        <div class="col-md-6 text-md-end">
          <div class="d-inline-flex gap-4">
            <div class="text-end">
              <label class="x-small-label d-block text-info">Date</label>
              <span class="fw-bold">{{ journal_details.date|date:"F d, Y" }}</span>
            </div>
            <div class="text-end border-start border-secondary border-opacity-25 ps-4">
              <label class="x-small-label d-block text-success">Total Debit</label>
              <span class="fw-bold">৳ {{ journal_details.total_debit }}</span>
            </div>
            <div class="text-end border-start border-secondary border-opacity-25 ps-4">
              <label class="x-small-label d-block text-danger">Total Credit</label>
              <span class="fw-bold">৳ {{ journal_details.total_credit }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="table-container shadow-lg overflow-hidden">
      <div class="table-responsive">
        <table class="table table-dark table-hover align-middle mb-0 ledger-table">
          <thead>
            <tr class="text-uppercase tracking-wider">
              <th class="ps-4">Time</th>
              <th>Particulars & References</th>
              <th class="amount-column">Debit</th>
              <th class="amount-column pe-4">Credit</th>
            </tr>
          </thead>
          <tbody>
            {% for journal in journals %}
            <tr class="border-bottom border-secondary border-opacity-10">
              <td class="ps-4 text-secondary small">
                {{ journal.date|date:"H:i" }}
              </td>
              <td class="description-cell py-3">
                <div class="text-white fw-bold small mb-1">{{ journal.description }}</div>
                <div class="d-flex gap-2">
                  {% if journal.ledger_ref %}
                    <span class="ref-badge"><i class="bi bi-book me-1"></i>L: #{{ journal.ledger_ref.pk }}</span>
                  {% endif %}
                  {% if journal.expense_ref %}
                    <span class="ref-badge text-warning border-warning border-opacity-25">
                      <i class="bi bi-wallet2 me-1"></i>EXP: #{{ journal.expense_ref.pk }}
                    </span>
                  {% endif %}
                </div>
              </td>
              <td class="amount-column text-success fw-bold">
                {% if journal.debit > 0 %}৳ {{ journal.debit }}{% else %}<span class="opacity-25">-</span>{% endif %}
              </td>
              <td class="amount-column pe-4 text-danger fw-bold">
                {% if journal.credit > 0 %}৳ {{ journal.credit }}{% else %}<span class="opacity-25">-</span>{% endif %}
              </td>
            </tr>
            {% empty %}
            <tr>
              <td colspan="4" class="text-center py-5 text-muted">
                <i class="bi bi-inbox fs-2 d-block mb-2 opacity-25"></i>
                No transaction entries found for this journal book.
              </td>
            </tr>
            {% endfor %}
          </tbody>
          <tfoot class="bg-black bg-opacity-25">
            <tr>
              <td colspan="2" class="ps-4 text-secondary small fw-bold text-uppercase">Summary Balance</td>
              <td class="amount-column text-success fw-bold py-3">৳ {{ journal_details.total_debit }}</td>
              <td class="amount-column pe-4 text-danger fw-bold py-3">৳ {{ journal_details.total_credit }}</td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>

    <div class="mt-4 d-flex justify-content-between align-items-center">
      <a href="{% url 'journal:journal-books-list' %}" class="btn btn-outline-secondary btn-sm px-3">
        <i class="bi bi-arrow-left me-1"></i> Back to Archive
      </a>
      <button class="btn btn-primary btn-sm px-4 fw-bold" onclick="window.print()">
        <i class="bi bi-printer me-1"></i> Print Voucher
      </button>
    </div>

  </div>
</section>
{% endblock content %}